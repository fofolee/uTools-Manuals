<html>
<body>
<FONT style="FONT: 12px 宋体" color=black>
<h3>函数功能</h3>该函数从单选列表框中检取当前选择。假定列表框已被DlgDirList函数填充，并且该选择为一个驱动器符，文件名，或目录名。<br>
函数原型:BOOL DlgDirSelectEx(HWND hDlg,LPTSTR lpString,int nCount,int nlDlistBox)；<br>
<h3>参数</h3>
hDlg：包含列表框的对话框句柄。<br>
lpString：接受选定的路径的缓冲区指针。<br>
nCount：定义lpstring指向的缓冲区中的字符串长度。<br>
NlDListBox：定义对话框中列表框的整数标识符。<br>
<h3>返回值</h3>若当前选择为目录名，则返回值不为0。若当前选择不是目录名，则返回值为0。若要获得更多的错误信息，可调用GetLastError函数。<br>
备注:DlgDirSelectEx函数把选择拷贝到lpString指向的缓冲区。若当前选择为一目录名或驱动器符，DlgDirSelectEx函数将去掉封闭的方形括号（对于驱动器符；还要去掉连字符），以便于将名字和符号插入到新的路径中。若没有选择，lpString的值不变。<br>
DlgDirSelectEx发送LB_GETCURSEL和LB_GETTEXT消息到列表框。该函数不允许从列表框返回多个文件名。该列表框一定不能是多选列表框。若为多选框，该函数不返回0值，且lpString的值不变。<br>
<h3>速查</h3>Windows nT：3.1及以上版本；Windows：95及以上版本；Windows CE：不支持；头文件；winuser.h；库文件：user32.lib; Unicode:在Windows NT上实现为Unicode和ANSI两种版本。<br>

</body>
</html>
