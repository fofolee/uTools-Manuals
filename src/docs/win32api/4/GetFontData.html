<html>
<body>

<h3>函数功能</h3>该函数得到一种字体的度量数据。<br>
<h3>函数原型</h3>DWORD GetFontData(HDC hdc, DWORD dwTable, DWORD dwOffset, LPVOID lpvBuffer, DWORD cbData)；<br>
<h3>参数</h3>
hdc：设备环境句柄。<br>
dwTable：指定字体度量表的名字，从度量表中可获得度量数据，此参数可确定归档于微软公司出版的TrueType字体文字规格说明中的度量表之一。如果此参数为零，得到的信息开始于字体文件的起始处。<br>
dwOffset：指定从字体度量表的起点开始的偏移量，以确定此函数获取信息的开始位置。如果此参数为0，则取回的信息开始于由dwTable指定的表的起点。如果此参数值大于或等于表的长度，将引发错误。<br>
lpbBuffer：指向缓冲区的指针，该缓冲区用于接收字体信息，如果此参数NULL，此函数返回能容纳字体信息的缓冲区的大小。<br>
cbData：指定要取回的信息的字节数。如果此参数为0，GetFontData返回由参数dwTable指定的数据的大小。<br>
<h3>返回值</h3>如果函数调用成功，返回值是返回的字节数；如果函数调用失败，返回值是GDI_ERROR。<br>
Windows NT：若想获得更多错误信息，请调用GetLastError函数。<br>
备注：应用程序可以不时地用函数GetFontData来将一种TrueType字体文件一起保存。要实现这一眯，应用程序检查OUTLINETEXTMETRIC结构里的otmfsType成员来确定字体是否嵌入。如果otmfsType的第一位被设置，则该字体不允许嵌入。如果第1位被清除，字体可被嵌入。如果第2位被设置，表示嵌入是只读的。如果允许嵌入，则应用程序可通过将dwTable, dwOffset和cbData置为0来取得整个字体文件。<br>
如果应用程序试图用此函数来取得一种非TrueType字体的信息，将引发错误。<br>
<h3>速查</h3>Windows NT：3.1及以上版本；Windows：95及以上版本；Windows CE：不支持；头文件：wingdi.h；库文件：gdi32.lib。<br>

</body>
</html>
