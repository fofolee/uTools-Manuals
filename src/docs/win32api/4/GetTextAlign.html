<html>
<body>
<FONT style="FONT: 12px 宋体" color=black>
<h3>函数功能</h3>该函数获得指定的设备环境下的文字对齐方式的设置。<br>
<h3>函数原型</h3>UINT GetTextAlign(HDC hdc)；<br>
<h3>参数</h3>
hdc：设备环境句柄。<br>
<h3>返回值</h3>如果函数调用成功，返回值是文字对齐标志的状态。要了解返回值的更多信息，参见备注。返回值是下列值的组合：<br>
TA_BASELINE：基准点在正文的基线上。TA_BOTTOM：基准点在限定矩形的下边界上。<br>
TA_TOP：基准点在限定矩形的上边界上。TA_CENTER：基准点与限定矩形的中心水平对齐。<br>
TA_LEFT：基准点在限定矩形的左边界上。TA_RIGHT：基准点在限定矩形的右边界上。<br>
TA_RTLREADING：对于中东Windows版，正文从右到左的阅读顺序排列，与缺省的从左到右正好相反。<br>
只有当被选择的字体是Hebrew或Arabic时，此值才有用。<br>
TA_NOUPDATECP：每次输出调用后当前状态不改变。TA_UPDATECP：每次输出调用后当前状态改变。<br>
若当前字体有一条缺省的垂直基线（如Kanji），下列值用于取代TA_BASELINE和TA_CENTER，各值含义为：<br>
VTA_BASELINE：基准点在正文的基线上。VTA_CENTER：基准点与限定矩形的中心垂直对齐。<br>
如果函数调用失败，返回值是GDI-ERROR。<br>
Windows：若想获得更多的错误信息，请调用GetLastError函数。<br>
备注：限定矩形是指能将正文字符串的所有字符单元限定于其中的矩形。其尺寸可调用GetTextextentPoint32来获得。<br>
文字对齐标志决定TextOut和ExtTextOut如何将正文字符串与基准点对齐。<br>
文字对齐标志不必是单个的标志位，可以等于0。标志必须按相关的组来检查，如下所示：<br>
TA_LEFT, TA_RIGHT和TA_CENTER, TA_BOTTOM, TA_TOP和TA_BASELINE；<br>
TA_NOUPDATECP和TA_UPDATECP。<br>
如果当前字体有缺省的垂直基线，相关的标志如下所示：<br>
TA_LEFT, TA_RIGHT和VTA_BASELINE, TA_BOTTOM, TA_TOP和VTA_CENTER；<br>
TA_NOUPDATECP和TA_UPDATECP。<br>
要验证一个特定的标志在返回值中被设置，应用程序必须执行以下步骤：<br>
对该标志及其相关标志实施位OR操作；<br>
对结果和返回值实施位AND操作；<br>
检查结果值和标志是否相等。<br>
<h3>速查</h3>Windows NT：3.1及以上版本；Windows：95及以上版本；Windows CE：不支持；头文件：wingdi.h；库文件：gdi32.lib。<br>

</body>
</html>
