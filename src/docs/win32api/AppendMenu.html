<html>
<body>
<FONT style="FONT: 12px 宋体" color=black>
<h3>函数功能</h3>该函数在指定的菜单条、下拉式菜单、子菜单或快捷菜单的末尾追加一个新菜单项。此函数可指定菜单项的内容、外观和性能。函数AppendMenu己被lnsertMenultem取代。但如果不需要lnsertMenultem的扩展特性，仍可使用AppendMenu。<br>
<h3>函数原型</h3>BOOL AppendMenu（hMenu hMenu，UINT uFlags，UINT uIDNewltem，LPCTSTR lpNewltem）;<br>
<h3>参数</h3>
hMenu：将被修改的菜单条、下拉式菜单、子菜单、或快捷菜单的句柄。<br>
UFlags：控制新菜单项的外观和性能的标志。此参数可以是备注里所列值的组合。<br>
UIDNewltem：指定新菜单项的标识符，或者当uFlags设置为MF_POPUP时，表示下拉式菜单或子菜单的句柄。<br>
LpNewltem：指定新菜单项的内容。此参数的含义取决于参数uFlags是否包含MF_BITMAP, MF_OWNERDRAW或MF_STRING标志，如下所示：<br>
MF_BITMAP：含有位图句柄。MF_STRING：以`\O’结束的字符串的指针。<br>
MF_OWNERDRAW：含有被应用程序应用的32位值，可以保留与菜单项有关的附加数据。当菜单被创建或其外观被修改时，此值在消息WM_MEASURE或WM_DRAWITEM的参数IParam指向的结构，成员itemData里。<br>
<h3>返回值</h3>如果函数调用成功，返回非零值；如果函数调用失败，返回值是零。若想获得更多的错误信息，请调用GetLastError函数。<br>
备注：一旦菜单被修改，无论它是否在显示窗口里，应用程序必须调用函数DrawMenuBar。<br>
为了使键盘加速键能控制位留或自己绘制的菜单项，菜单的拥有者必须处理WM_MENUCHAR消息。<br>
参见自绘制菜单和WM_MENUCHAR消息。<br>
下列标志可被设置在参数uFlags里：<br>
MF_BITMAP：将一个位图用作菜单项。参数lpNewltem里含有该位图的句柄。<br>
MF_CHECKED：在菜单项旁边放置一个选取标记。如果应用程序提供一个选取标记，位图（参见SetMenultemBitmaps），则将选取标记位图放置在菜单项旁边。<br>
MF_DISABLED：使菜单项无效，使该项不能被选择，但不使菜单项变灰。<br>
MF_ENABLED：使菜单项有效，使该项能被选择，并使其从变灰的状态恢复。<br>
MF_GRAYED：使菜单项无效并变灰，使其不能被选择。<br>
MF_MENUBARBREAK：对菜单条的功能同MF_MENUBREAK标志。对下拉式菜单、子菜单或快捷菜单，新列和旧列被垂直线分开。<br>
MF_MENUBREAK：将菜单项放置于新行（对菜单条），或新列（对下拉式菜单、子菜单或快捷菜单）且无分割列。<br>
MF_OWNERDRAW：指定该菜单项为自绘制菜单项。菜单第一次显示前，拥有菜单的窗口接收一个WM_MEASUREITEM消息来得到菜单项的宽和高。然后，只要菜单项被修改，都将发送WM_DRAWITEM消息给菜单拥有者的窗口程序。<br>
MF_POPUP：指定菜单打开一个下拉式菜单或子菜单。参数uIDNewltem下拉式菜单或子菜单的句柄。此标志用来给菜单条、打开一个下拉式菜单或于菜单的菜单项、子菜单或快捷菜单加一个名字。<br>
MF_SEPARATOR：画一条水平区分线。此标志只被下拉式菜单、于菜单或快捷菜单使用。此区分线不能被变灰、无效或加亮。参数IpNewltem和uIDNewltem无用。<br>
MF_STRING：指定菜单项是一个正文字符串；参数lpNewltem指向该字符串。<br>
MF_UNCHECKED：不放置选取标记在菜单项旁边（缺省）。如果应用程序提供一个选取标记位图（参见SetMenultemBitmaps），则将选取标记位图放置在菜单项旁边。<br>
下列标志组不能被一起使用：<br>
MF_DISABLED，MF_ENABLED和MF_GRAYED；MF_BITMAP,MF_STRING和MF_OWNERDRAW<br>
MF_MENUBARBREAK和MF_MENUBREAK；MF_CHECKED和MF_UNCHECKED<br>
Windows CE环境下，不支持参数fuFlags使用下列标志：<br>
MF_BITMAP；MF_DOSABLE；MF_GRAYED<br>
MF_GRAYED可用来代替MF_DISABLED和MFS_GRAYED。<br>
Windows CE 1.0不支持层叠式菜单。在使用Windows CE 1.0时，不能将一个MF_POPUP菜单插入到另一个下拉式菜单中。Window CE 1.0不支持下列标志：<br>
MF_POPUP；MF_MENUBREAK；MF_MENUBARBREAK<br>
Windows CE 2.0或更高版本中，支持上述标志，也支持层叠式菜单。<br>


</body>
</html>
