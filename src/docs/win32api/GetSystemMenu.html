<html>
<body>

<h3>函数功能</h3>该函数允许应用程序为复制或修改而访问窗口菜单（系统菜单或控制菜单）。<br>
<h3>函数原型</h3>HMENU GetSystemMenu(HWND hWnd,BOOL bRevert)；<br>
<h3>参数</h3>
hWvd：拥有窗口菜单拷贝的窗口的句柄。<br>
BPevert：指定将执行的操作。如果此参数为FALSE，GetSystemMenu返回当前使用窗口菜单的拷贝的句柄。该拷贝初始时与窗口菜单相同，但可以被修改。<br>
如果此参数为TRUE，GetSystemMenu重置窗口菜单到缺省状态。如果存在先前的窗口菜单，将被销毁。<br>
<h3>返回值</h3>如果参数bRevert为FALSE，返回值是窗口菜单的拷贝的句柄：如果参数bRevert为TRUE，返回值是NULL。<br>
备注：任何没有用函数GetSystemMenu来生成自己的窗口菜单拷贝的窗口将接受标准窗口菜单。<br>
窗口某单最初包含的菜单项有多种标识符值，如SC_CLOSE，SC_MOVE和SC_SIZE。<br>
窗口菜单上的菜单项发送WM_SYSCOMMAND消息。<br>
所有预定义的窗口菜单项的标识符数大于OxFOOO。如果一个应用程序增加命令到窗口菜单，应该使用小于OxFOOO的标识符数。<br>
系统根据状态自动变灰标准窗口菜单上的菜单项。应用程序通过响应在任何某单显示之前发送的WM_INITMENU消息来实现选取和变灰。<br>
Windows CE环境下，不支持系统菜单，但GetSyemMenu以宏的方式实现，以保持和已存在代码的兼容性。可以使用该宏的返回菜单句柄使关闭框无效，与在Windows桌面平台上一样。Windows CE下的返回值没有其他用处。参数bRevert无用。<br>
用下面的代码使关闭按钮无效：<br>
EnableMenultem（GetSystemMenu（hwnd，FALSE），SC_CLOSE，MF_BYCOMMAND I MF_GRAYED）；<br>
<h3>速查</h3>Windows NT：3.1及以上版本；Windows：95及以上版本；Windows CE：1.0及以上版本；头文件：winuser.h；输人库：user32.lib。<br>

</body>
</html>
